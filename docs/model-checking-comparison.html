<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Model checking / comparison | STAT 764 - Spring 2024</title>
  <meta name="description" content="10 Model checking / comparison | STAT 764 - Spring 2024" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Model checking / comparison | STAT 764 - Spring 2024" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Model checking / comparison | STAT 764 - Spring 2024" />
  
  
  

<meta name="author" content="Valentina M. Pereyra Picabea" />


<meta name="date" content="2024-05-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-model.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 764 - Valentina Pereyra</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="daily-journals.html"><a href="daily-journals.html"><i class="fa fa-check"></i><b>1</b> Daily journals</a>
<ul>
<li class="chapter" data-level="1.1" data-path="daily-journals.html"><a href="daily-journals.html#january-18"><i class="fa fa-check"></i><b>1.1</b> January 18</a></li>
<li class="chapter" data-level="1.2" data-path="daily-journals.html"><a href="daily-journals.html#january-25"><i class="fa fa-check"></i><b>1.2</b> January 25</a></li>
<li class="chapter" data-level="1.3" data-path="daily-journals.html"><a href="daily-journals.html#january-30"><i class="fa fa-check"></i><b>1.3</b> January 30</a></li>
<li class="chapter" data-level="1.4" data-path="daily-journals.html"><a href="daily-journals.html#february-1"><i class="fa fa-check"></i><b>1.4</b> February 1</a></li>
<li class="chapter" data-level="1.5" data-path="daily-journals.html"><a href="daily-journals.html#february-6"><i class="fa fa-check"></i><b>1.5</b> February 6</a></li>
<li class="chapter" data-level="1.6" data-path="daily-journals.html"><a href="daily-journals.html#february-8"><i class="fa fa-check"></i><b>1.6</b> February 8</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="daily-journals.html"><a href="daily-journals.html#cleaned"><i class="fa fa-check"></i><b>1.6.1</b> Cleaned</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="daily-journals.html"><a href="daily-journals.html#februrart-13"><i class="fa fa-check"></i><b>1.7</b> Februrart 13</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="daily-journals.html"><a href="daily-journals.html#cleaned-1"><i class="fa fa-check"></i><b>1.7.1</b> Cleaned</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="daily-journals.html"><a href="daily-journals.html#february-15"><i class="fa fa-check"></i><b>1.8</b> February 15</a></li>
<li class="chapter" data-level="1.9" data-path="daily-journals.html"><a href="daily-journals.html#february-20"><i class="fa fa-check"></i><b>1.9</b> February 20</a></li>
<li class="chapter" data-level="1.10" data-path="daily-journals.html"><a href="daily-journals.html#february-22"><i class="fa fa-check"></i><b>1.10</b> February 22</a></li>
<li class="chapter" data-level="1.11" data-path="daily-journals.html"><a href="daily-journals.html#february-27"><i class="fa fa-check"></i><b>1.11</b> February 27</a></li>
<li class="chapter" data-level="1.12" data-path="daily-journals.html"><a href="daily-journals.html#february-29"><i class="fa fa-check"></i><b>1.12</b> February 29</a></li>
<li class="chapter" data-level="1.13" data-path="daily-journals.html"><a href="daily-journals.html#march-7"><i class="fa fa-check"></i><b>1.13</b> March 7</a></li>
<li class="chapter" data-level="1.14" data-path="daily-journals.html"><a href="daily-journals.html#march-19"><i class="fa fa-check"></i><b>1.14</b> March 19</a></li>
<li class="chapter" data-level="1.15" data-path="daily-journals.html"><a href="daily-journals.html#march-21"><i class="fa fa-check"></i><b>1.15</b> March 21</a></li>
<li class="chapter" data-level="1.16" data-path="daily-journals.html"><a href="daily-journals.html#march-26"><i class="fa fa-check"></i><b>1.16</b> March 26</a></li>
<li class="chapter" data-level="1.17" data-path="daily-journals.html"><a href="daily-journals.html#march-28"><i class="fa fa-check"></i><b>1.17</b> March 28</a></li>
<li class="chapter" data-level="1.18" data-path="daily-journals.html"><a href="daily-journals.html#april-2"><i class="fa fa-check"></i><b>1.18</b> April 2</a></li>
<li class="chapter" data-level="1.19" data-path="daily-journals.html"><a href="daily-journals.html#april-4"><i class="fa fa-check"></i><b>1.19</b> April 4</a></li>
<li class="chapter" data-level="1.20" data-path="daily-journals.html"><a href="daily-journals.html#april-11"><i class="fa fa-check"></i><b>1.20</b> April 11</a></li>
<li class="chapter" data-level="1.21" data-path="daily-journals.html"><a href="daily-journals.html#april-16"><i class="fa fa-check"></i><b>1.21</b> April 16</a></li>
<li class="chapter" data-level="1.22" data-path="daily-journals.html"><a href="daily-journals.html#april-18"><i class="fa fa-check"></i><b>1.22</b> April 18</a></li>
<li class="chapter" data-level="1.23" data-path="daily-journals.html"><a href="daily-journals.html#april-23"><i class="fa fa-check"></i><b>1.23</b> April 23</a></li>
<li class="chapter" data-level="1.24" data-path="daily-journals.html"><a href="daily-journals.html#april-30"><i class="fa fa-check"></i><b>1.24</b> April 30</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html"><i class="fa fa-check"></i><b>2</b> Activity 1 - Morning walk</a>
<ul>
<li class="chapter" data-level="2.1" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#libraries"><i class="fa fa-check"></i><b>2.1</b> Libraries</a></li>
<li class="chapter" data-level="2.2" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#data"><i class="fa fa-check"></i><b>2.2</b> Data</a></li>
<li class="chapter" data-level="2.3" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#visualize-map"><i class="fa fa-check"></i><b>2.3</b> Visualize map</a></li>
<li class="chapter" data-level="2.4" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#write-kml"><i class="fa fa-check"></i><b>2.4</b> Write kml</a></li>
<li class="chapter" data-level="2.5" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#visualize-lat-lon"><i class="fa fa-check"></i><b>2.5</b> Visualize lat lon</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#polynomial"><i class="fa fa-check"></i><b>2.5.1</b> 1. Polynomial</a></li>
<li class="chapter" data-level="2.5.2" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#gam---low-rank-gaussian-process"><i class="fa fa-check"></i><b>2.5.2</b> 2. GAM - low rank gaussian process</a></li>
<li class="chapter" data-level="2.5.3" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#regression-tree"><i class="fa fa-check"></i><b>2.5.3</b> 3. Regression tree</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#visualize-all"><i class="fa fa-check"></i><b>2.6</b> Visualize all</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#comments"><i class="fa fa-check"></i><b>2.6.1</b> 4. Comments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><i class="fa fa-check"></i><b>3</b> Elevation data of Experiment plot in North Agronomy Farm</a>
<ul>
<li class="chapter" data-level="3.1" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#librarires"><i class="fa fa-check"></i><b>3.1</b> Librarires</a></li>
<li class="chapter" data-level="3.2" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#kansas-boundary"><i class="fa fa-check"></i><b>3.2</b> Kansas boundary</a></li>
<li class="chapter" data-level="3.3" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#my-data-north-agronomy-farm"><i class="fa fa-check"></i><b>3.3</b> My data: North Agronomy Farm</a></li>
<li class="chapter" data-level="3.4" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#extract-elevation"><i class="fa fa-check"></i><b>3.4</b> Extract elevation</a></li>
<li class="chapter" data-level="3.5" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#visualize-boundary-elevation"><i class="fa fa-check"></i><b>3.5</b> Visualize boundary + elevation</a></li>
<li class="chapter" data-level="3.6" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#models"><i class="fa fa-check"></i><b>3.6</b> Models</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#linear-with-iid-errors"><i class="fa fa-check"></i><b>3.6.1</b> 1. Linear with iid errors</a></li>
<li class="chapter" data-level="3.6.2" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#gam"><i class="fa fa-check"></i><b>3.6.2</b> 2. GAM</a></li>
<li class="chapter" data-level="3.6.3" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#regression-tree-1"><i class="fa fa-check"></i><b>3.6.3</b> 3. Regression tree</a></li>
<li class="chapter" data-level="3.6.4" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#support-vector-regression"><i class="fa fa-check"></i><b>3.6.4</b> 4. Support vector regression</a></li>
<li class="chapter" data-level="3.6.5" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#boosted-regession-tree"><i class="fa fa-check"></i><b>3.6.5</b> 5. Boosted regession tree</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="activity-3.html"><a href="activity-3.html"><i class="fa fa-check"></i><b>4</b> Activity 3</a>
<ul>
<li class="chapter" data-level="4.1" data-path="activity-3.html"><a href="activity-3.html#libraries-1"><i class="fa fa-check"></i><b>4.1</b> Libraries</a></li>
<li class="chapter" data-level="4.2" data-path="activity-3.html"><a href="activity-3.html#english-grain-aphid-data"><i class="fa fa-check"></i><b>4.2</b> English grain Aphid Data</a></li>
<li class="chapter" data-level="4.3" data-path="activity-3.html"><a href="activity-3.html#kansas"><i class="fa fa-check"></i><b>4.3</b> Kansas</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spatial-df.html"><a href="spatial-df.html"><i class="fa fa-check"></i><b>5</b> Spatial DF</a></li>
<li class="chapter" data-level="6" data-path="viz-count.html"><a href="viz-count.html"><i class="fa fa-check"></i><b>6</b> Viz count</a>
<ul>
<li class="chapter" data-level="6.1" data-path="viz-count.html"><a href="viz-count.html#land-cover-data"><i class="fa fa-check"></i><b>6.1</b> Land Cover data</a></li>
<li class="chapter" data-level="6.2" data-path="viz-count.html"><a href="viz-count.html#raster-w-grassland"><i class="fa fa-check"></i><b>6.2</b> Raster w grassland</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="grassland-within-5-km-of-sampling.html"><a href="grassland-within-5-km-of-sampling.html"><i class="fa fa-check"></i><b>7</b> Grassland within 5 km of sampling</a></li>
<li class="chapter" data-level="8" data-path="run-models.html"><a href="run-models.html"><i class="fa fa-check"></i><b>8</b> Run models</a></li>
<li class="chapter" data-level="9" data-path="statistical-model.html"><a href="statistical-model.html"><i class="fa fa-check"></i><b>9</b> Statistical model</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistical-model.html"><a href="statistical-model.html#compare-models"><i class="fa fa-check"></i><b>9.1</b> Compare models</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistical-model.html"><a href="statistical-model.html#concurvity"><i class="fa fa-check"></i><b>9.1.1</b> Concurvity</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistical-model.html"><a href="statistical-model.html#semivariogram-for-corr-resids"><i class="fa fa-check"></i><b>9.2</b> Semivariogram for corr resids</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-checking-comparison.html"><a href="model-checking-comparison.html"><i class="fa fa-check"></i><b>10</b> Model checking / comparison</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-checking-comparison.html"><a href="model-checking-comparison.html#predictions-in-space"><i class="fa fa-check"></i><b>10.1</b> Predictions in space</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="model-checking-comparison.html"><a href="model-checking-comparison.html#summary"><i class="fa fa-check"></i><b>10.1.1</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 764 - Spring 2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-checking-comparison" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">10</span> Model checking / comparison<a href="model-checking-comparison.html#model-checking-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="model-checking-comparison.html#cb133-1" tabindex="-1"></a>E.y.m1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,<span class="at">newdata=</span>test,<span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb133-2"><a href="model-checking-comparison.html#cb133-2" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dnorm</span>(test<span class="sc">$</span>EGA,E.y.m1,<span class="at">log=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## [1] -257906.7</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="model-checking-comparison.html#cb135-1" tabindex="-1"></a><span class="fu">mean</span>((test<span class="sc">$</span>EGA <span class="sc">-</span> E.y.m1)<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Mean square error</span></span></code></pre></div>
<pre><code>## [1] 4191.766</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="model-checking-comparison.html#cb137-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(test<span class="sc">$</span>EGA <span class="sc">-</span> E.y.m1)) <span class="co"># Mean absolute error</span></span></code></pre></div>
<pre><code>## [1] 24.24915</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="model-checking-comparison.html#cb139-1" tabindex="-1"></a><span class="fu">plot</span>(E.y.m1,test<span class="sc">$</span>EGA,<span class="at">xlab=</span><span class="st">&quot;Predicted expected value&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;New observed number of aphids&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="model-checking-comparison.html#cb140-1" tabindex="-1"></a>E.y.m2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m2,<span class="at">newdata=</span>test,<span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb140-2"><a href="model-checking-comparison.html#cb140-2" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dnorm</span>(test<span class="sc">$</span>EGA,E.y.m1,<span class="at">log=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## [1] -257906.7</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="model-checking-comparison.html#cb142-1" tabindex="-1"></a><span class="fu">mean</span>((test<span class="sc">$</span>EGA <span class="sc">-</span> E.y.m2)<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Mean square error</span></span></code></pre></div>
<pre><code>## [1] 3809.002</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="model-checking-comparison.html#cb144-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(test<span class="sc">$</span>EGA <span class="sc">-</span> E.y.m2)) <span class="co"># Mean absolute error</span></span></code></pre></div>
<pre><code>## [1] 24.1772</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="model-checking-comparison.html#cb146-1" tabindex="-1"></a><span class="fu">plot</span>(E.y.m2,test<span class="sc">$</span>EGA,<span class="at">xlab=</span><span class="st">&quot;Predicted expected value&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;New observed number of aphids&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="model-checking-comparison.html#cb147-1" tabindex="-1"></a>E.y.m3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m3,<span class="at">newdata=</span>test,<span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb147-2"><a href="model-checking-comparison.html#cb147-2" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dnorm</span>(test<span class="sc">$</span>EGA,E.y.m1,<span class="at">log=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## [1] -257906.7</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="model-checking-comparison.html#cb149-1" tabindex="-1"></a><span class="fu">mean</span>((test<span class="sc">$</span>EGA <span class="sc">-</span> E.y.m3)<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Mean square error</span></span></code></pre></div>
<pre><code>## [1] 4482.854</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="model-checking-comparison.html#cb151-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(test<span class="sc">$</span>EGA <span class="sc">-</span> E.y.m3)) <span class="co"># Mean absolute error</span></span></code></pre></div>
<pre><code>## [1] 22.563</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="model-checking-comparison.html#cb153-1" tabindex="-1"></a><span class="fu">plot</span>(E.y.m3,test<span class="sc">$</span>EGA,<span class="at">xlab=</span><span class="st">&quot;Predicted expected value&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;New observed number of aphids&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-3.png" width="672" /></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="model-checking-comparison.html#cb154-1" tabindex="-1"></a>E.y.m4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m4,<span class="at">newdata=</span>test,<span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb154-2"><a href="model-checking-comparison.html#cb154-2" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dnorm</span>(test<span class="sc">$</span>EGA,E.y.m4,<span class="at">log=</span><span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## [1] -271978.1</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="model-checking-comparison.html#cb156-1" tabindex="-1"></a><span class="fu">mean</span>((test<span class="sc">$</span>EGA <span class="sc">-</span> E.y.m4)<span class="sc">^</span><span class="dv">2</span>) <span class="co"># Mean square error</span></span></code></pre></div>
<pre><code>## [1] 4420.57</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="model-checking-comparison.html#cb158-1" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(test<span class="sc">$</span>EGA <span class="sc">-</span> E.y.m4)) <span class="co"># Mean absolute error</span></span></code></pre></div>
<pre><code>## [1] 34.55037</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="model-checking-comparison.html#cb160-1" tabindex="-1"></a><span class="fu">plot</span>(E.y.m4,test<span class="sc">$</span>EGA,<span class="at">xlab=</span><span class="st">&quot;Predicted expected value&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;New observed number of aphids&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-36-4.png" width="672" /></p>
<div id="predictions-in-space" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Predictions in space<a href="model-checking-comparison.html#predictions-in-space" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="model-checking-comparison.html#cb161-1" tabindex="-1"></a>newPoints <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(sf.kansas <span class="sc">%&gt;%</span> <span class="fu">st_as_sf</span>(), <span class="at">size =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">&quot;regular&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb161-2"><a href="model-checking-comparison.html#cb161-2" tabindex="-1"></a>  <span class="fu">as</span>(., <span class="st">&#39;Spatial&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb161-3"><a href="model-checking-comparison.html#cb161-3" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="st">&quot;long&quot;</span> <span class="ot">=</span> <span class="st">&quot;coords.x1&quot;</span>, </span>
<span id="cb161-4"><a href="model-checking-comparison.html#cb161-4" tabindex="-1"></a>           <span class="st">&quot;lat&quot;</span> <span class="ot">=</span> <span class="st">&quot;coords.x2&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb161-5"><a href="model-checking-comparison.html#cb161-5" tabindex="-1"></a>  <span class="fu">cross_join</span>(<span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">&#39;2014&#39;</span>, <span class="st">&#39;2015&#39;</span>))))</span>
<span id="cb161-6"><a href="model-checking-comparison.html#cb161-6" tabindex="-1"></a></span>
<span id="cb161-7"><a href="model-checking-comparison.html#cb161-7" tabindex="-1"></a>pts.sample <span class="ot">&lt;-</span> newPoints</span>
<span id="cb161-8"><a href="model-checking-comparison.html#cb161-8" tabindex="-1"></a></span>
<span id="cb161-9"><a href="model-checking-comparison.html#cb161-9" tabindex="-1"></a><span class="fu">coordinates</span>(pts.sample) <span class="ot">=</span><span class="er">~</span> long <span class="sc">+</span> lat</span>
<span id="cb161-10"><a href="model-checking-comparison.html#cb161-10" tabindex="-1"></a><span class="fu">proj4string</span>(pts.sample) <span class="ot">&lt;-</span> <span class="fu">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;</span>)</span>
<span id="cb161-11"><a href="model-checking-comparison.html#cb161-11" tabindex="-1"></a></span>
<span id="cb161-12"><a href="model-checking-comparison.html#cb161-12" tabindex="-1"></a><span class="co"># Calculate percentage of land area that is grassland withing 5 km of new points location</span></span>
<span id="cb161-13"><a href="model-checking-comparison.html#cb161-13" tabindex="-1"></a>newPoints<span class="sc">$</span>grass.perc <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(raster<span class="sc">::</span><span class="fu">extract</span>(rl.nlcd.grass,pts.sample,<span class="at">buffer=</span><span class="dv">5000</span>),mean))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb161-14"><a href="model-checking-comparison.html#cb161-14" tabindex="-1"></a></span>
<span id="cb161-15"><a href="model-checking-comparison.html#cb161-15" tabindex="-1"></a><span class="co"># Step 2: obtain predictions</span></span>
<span id="cb161-16"><a href="model-checking-comparison.html#cb161-16" tabindex="-1"></a>newPoints<span class="sc">$</span>pred.m1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1, <span class="at">newdata =</span> newPoints, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb161-17"><a href="model-checking-comparison.html#cb161-17" tabindex="-1"></a>newPoints<span class="sc">$</span>pred.m2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m2, <span class="at">newdata =</span> newPoints, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb161-18"><a href="model-checking-comparison.html#cb161-18" tabindex="-1"></a>newPoints<span class="sc">$</span>pred.m3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m3, <span class="at">newdata =</span> newPoints, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb161-19"><a href="model-checking-comparison.html#cb161-19" tabindex="-1"></a>newPoints<span class="sc">$</span>pred.m4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(m4, <span class="at">newdata =</span> newPoints, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="model-checking-comparison.html#cb162-1" tabindex="-1"></a><span class="co"># Model 1</span></span>
<span id="cb162-2"><a href="model-checking-comparison.html#cb162-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb162-3"><a href="model-checking-comparison.html#cb162-3" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> newPoints <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pred.m1 <span class="sc">&lt;</span> <span class="dv">2000</span>), <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">fill =</span> pred.m1))<span class="sc">+</span></span>
<span id="cb162-4"><a href="model-checking-comparison.html#cb162-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model 1: Abundance of English grain aphids&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>)<span class="sc">+</span></span>
<span id="cb162-5"><a href="model-checking-comparison.html#cb162-5" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>)<span class="sc">+</span></span>
<span id="cb162-6"><a href="model-checking-comparison.html#cb162-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb162-7"><a href="model-checking-comparison.html#cb162-7" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb162-8"><a href="model-checking-comparison.html#cb162-8" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb162-9"><a href="model-checking-comparison.html#cb162-9" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>),</span>
<span id="cb162-10"><a href="model-checking-comparison.html#cb162-10" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb162-11"><a href="model-checking-comparison.html#cb162-11" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb162-12"><a href="model-checking-comparison.html#cb162-12" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb162-13"><a href="model-checking-comparison.html#cb162-13" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb162-14"><a href="model-checking-comparison.html#cb162-14" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb162-15"><a href="model-checking-comparison.html#cb162-15" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span></span>
<span id="cb162-16"><a href="model-checking-comparison.html#cb162-16" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">size =</span> EGA), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="1152" /></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="model-checking-comparison.html#cb163-1" tabindex="-1"></a><span class="co"># Model 2</span></span>
<span id="cb163-2"><a href="model-checking-comparison.html#cb163-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb163-3"><a href="model-checking-comparison.html#cb163-3" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> newPoints, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">fill =</span> pred.m2))<span class="sc">+</span></span>
<span id="cb163-4"><a href="model-checking-comparison.html#cb163-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model 2: Abundance of English grain aphids&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>)<span class="sc">+</span></span>
<span id="cb163-5"><a href="model-checking-comparison.html#cb163-5" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>)<span class="sc">+</span></span>
<span id="cb163-6"><a href="model-checking-comparison.html#cb163-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb163-7"><a href="model-checking-comparison.html#cb163-7" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb163-8"><a href="model-checking-comparison.html#cb163-8" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb163-9"><a href="model-checking-comparison.html#cb163-9" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>),</span>
<span id="cb163-10"><a href="model-checking-comparison.html#cb163-10" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb163-11"><a href="model-checking-comparison.html#cb163-11" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb163-12"><a href="model-checking-comparison.html#cb163-12" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb163-13"><a href="model-checking-comparison.html#cb163-13" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb163-14"><a href="model-checking-comparison.html#cb163-14" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb163-15"><a href="model-checking-comparison.html#cb163-15" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span></span>
<span id="cb163-16"><a href="model-checking-comparison.html#cb163-16" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">size =</span> EGA), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="1152" /></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="model-checking-comparison.html#cb164-1" tabindex="-1"></a><span class="co"># Model 3</span></span>
<span id="cb164-2"><a href="model-checking-comparison.html#cb164-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb164-3"><a href="model-checking-comparison.html#cb164-3" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> newPoints <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pred.m3 <span class="sc">&lt;</span> <span class="dv">1000</span>), <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">fill =</span> pred.m3))<span class="sc">+</span></span>
<span id="cb164-4"><a href="model-checking-comparison.html#cb164-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model 3: Abundance of English grain aphids&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>)<span class="sc">+</span></span>
<span id="cb164-5"><a href="model-checking-comparison.html#cb164-5" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>)<span class="sc">+</span></span>
<span id="cb164-6"><a href="model-checking-comparison.html#cb164-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb164-7"><a href="model-checking-comparison.html#cb164-7" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb164-8"><a href="model-checking-comparison.html#cb164-8" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb164-9"><a href="model-checking-comparison.html#cb164-9" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>),</span>
<span id="cb164-10"><a href="model-checking-comparison.html#cb164-10" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb164-11"><a href="model-checking-comparison.html#cb164-11" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb164-12"><a href="model-checking-comparison.html#cb164-12" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb164-13"><a href="model-checking-comparison.html#cb164-13" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb164-14"><a href="model-checking-comparison.html#cb164-14" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb164-15"><a href="model-checking-comparison.html#cb164-15" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span></span>
<span id="cb164-16"><a href="model-checking-comparison.html#cb164-16" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">size =</span> EGA), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="1152" /></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="model-checking-comparison.html#cb165-1" tabindex="-1"></a><span class="co"># Model 4</span></span>
<span id="cb165-2"><a href="model-checking-comparison.html#cb165-2" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb165-3"><a href="model-checking-comparison.html#cb165-3" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data =</span> newPoints, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">fill =</span> pred.m4))<span class="sc">+</span></span>
<span id="cb165-4"><a href="model-checking-comparison.html#cb165-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model 4: Abundance of English grain aphids&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>)<span class="sc">+</span></span>
<span id="cb165-5"><a href="model-checking-comparison.html#cb165-5" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.95</span>)<span class="sc">+</span></span>
<span id="cb165-6"><a href="model-checking-comparison.html#cb165-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">colour =</span> <span class="cn">NA</span>),</span>
<span id="cb165-7"><a href="model-checking-comparison.html#cb165-7" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb165-8"><a href="model-checking-comparison.html#cb165-8" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb165-9"><a href="model-checking-comparison.html#cb165-9" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>),</span>
<span id="cb165-10"><a href="model-checking-comparison.html#cb165-10" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb165-11"><a href="model-checking-comparison.html#cb165-11" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb165-12"><a href="model-checking-comparison.html#cb165-12" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb165-13"><a href="model-checking-comparison.html#cb165-13" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb165-14"><a href="model-checking-comparison.html#cb165-14" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb165-15"><a href="model-checking-comparison.html#cb165-15" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year) <span class="sc">+</span></span>
<span id="cb165-16"><a href="model-checking-comparison.html#cb165-16" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df1, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, <span class="at">size =</span> EGA), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-41-1.png" width="1152" /></p>
<div id="summary" class="section level3 hasAnchor" number="10.1.1">
<h3><span class="header-section-number">10.1.1</span> Summary<a href="model-checking-comparison.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The model with the most accurate prediction is the negative binomial in the 1st place (MAE = 23 English Grain Aphid), and the gaussian in the 2nd place(MAE = 37 English Grain Aphid). In real world terms, however, the gaussian distribution assumes continuous observations in all the range of numbers (<span class="math inline">\(\overset{+}{\_} \infty\)</span>) which does not correlate with count data (positive integers). In addition, when we predict the number of aphids for Kansas, the poisson and the zero inflated poisson estimate extreme high values in the north west region.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-model.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-Activity3.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["book.pdf", "PDF"], ["book.epub", "EPUB"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
