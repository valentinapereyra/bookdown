<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Elevation data of Experiment plot in North Agronomy Farm | STAT 764 - Spring 2024</title>
  <meta name="description" content="3 Elevation data of Experiment plot in North Agronomy Farm | STAT 764 - Spring 2024" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Elevation data of Experiment plot in North Agronomy Farm | STAT 764 - Spring 2024" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Elevation data of Experiment plot in North Agronomy Farm | STAT 764 - Spring 2024" />
  
  
  

<meta name="author" content="Valentina M. Pereyra Picabea" />


<meta name="date" content="2024-05-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="activity-1---morning-walk.html"/>
<link rel="next" href="activity-3.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.1/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.1/leaflet-providers-plugin.js"></script>
<link href="libs/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="libs/HomeButton-0.0.1/home-button.js"></script>
<script src="libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 764 - Valentina Pereyra</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="daily-journals.html"><a href="daily-journals.html"><i class="fa fa-check"></i><b>1</b> Daily journals</a>
<ul>
<li class="chapter" data-level="1.1" data-path="daily-journals.html"><a href="daily-journals.html#january-18"><i class="fa fa-check"></i><b>1.1</b> January 18</a></li>
<li class="chapter" data-level="1.2" data-path="daily-journals.html"><a href="daily-journals.html#january-25"><i class="fa fa-check"></i><b>1.2</b> January 25</a></li>
<li class="chapter" data-level="1.3" data-path="daily-journals.html"><a href="daily-journals.html#january-30"><i class="fa fa-check"></i><b>1.3</b> January 30</a></li>
<li class="chapter" data-level="1.4" data-path="daily-journals.html"><a href="daily-journals.html#february-1"><i class="fa fa-check"></i><b>1.4</b> February 1</a></li>
<li class="chapter" data-level="1.5" data-path="daily-journals.html"><a href="daily-journals.html#february-6"><i class="fa fa-check"></i><b>1.5</b> February 6</a></li>
<li class="chapter" data-level="1.6" data-path="daily-journals.html"><a href="daily-journals.html#february-8"><i class="fa fa-check"></i><b>1.6</b> February 8</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="daily-journals.html"><a href="daily-journals.html#cleaned"><i class="fa fa-check"></i><b>1.6.1</b> Cleaned</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="daily-journals.html"><a href="daily-journals.html#februrart-13"><i class="fa fa-check"></i><b>1.7</b> Februrart 13</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="daily-journals.html"><a href="daily-journals.html#cleaned-1"><i class="fa fa-check"></i><b>1.7.1</b> Cleaned</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="daily-journals.html"><a href="daily-journals.html#february-15"><i class="fa fa-check"></i><b>1.8</b> February 15</a></li>
<li class="chapter" data-level="1.9" data-path="daily-journals.html"><a href="daily-journals.html#february-20"><i class="fa fa-check"></i><b>1.9</b> February 20</a></li>
<li class="chapter" data-level="1.10" data-path="daily-journals.html"><a href="daily-journals.html#february-22"><i class="fa fa-check"></i><b>1.10</b> February 22</a></li>
<li class="chapter" data-level="1.11" data-path="daily-journals.html"><a href="daily-journals.html#february-27"><i class="fa fa-check"></i><b>1.11</b> February 27</a></li>
<li class="chapter" data-level="1.12" data-path="daily-journals.html"><a href="daily-journals.html#february-29"><i class="fa fa-check"></i><b>1.12</b> February 29</a></li>
<li class="chapter" data-level="1.13" data-path="daily-journals.html"><a href="daily-journals.html#march-7"><i class="fa fa-check"></i><b>1.13</b> March 7</a></li>
<li class="chapter" data-level="1.14" data-path="daily-journals.html"><a href="daily-journals.html#march-19"><i class="fa fa-check"></i><b>1.14</b> March 19</a></li>
<li class="chapter" data-level="1.15" data-path="daily-journals.html"><a href="daily-journals.html#march-21"><i class="fa fa-check"></i><b>1.15</b> March 21</a></li>
<li class="chapter" data-level="1.16" data-path="daily-journals.html"><a href="daily-journals.html#march-26"><i class="fa fa-check"></i><b>1.16</b> March 26</a></li>
<li class="chapter" data-level="1.17" data-path="daily-journals.html"><a href="daily-journals.html#march-28"><i class="fa fa-check"></i><b>1.17</b> March 28</a></li>
<li class="chapter" data-level="1.18" data-path="daily-journals.html"><a href="daily-journals.html#april-2"><i class="fa fa-check"></i><b>1.18</b> April 2</a></li>
<li class="chapter" data-level="1.19" data-path="daily-journals.html"><a href="daily-journals.html#april-4"><i class="fa fa-check"></i><b>1.19</b> April 4</a></li>
<li class="chapter" data-level="1.20" data-path="daily-journals.html"><a href="daily-journals.html#april-11"><i class="fa fa-check"></i><b>1.20</b> April 11</a></li>
<li class="chapter" data-level="1.21" data-path="daily-journals.html"><a href="daily-journals.html#april-16"><i class="fa fa-check"></i><b>1.21</b> April 16</a></li>
<li class="chapter" data-level="1.22" data-path="daily-journals.html"><a href="daily-journals.html#april-18"><i class="fa fa-check"></i><b>1.22</b> April 18</a></li>
<li class="chapter" data-level="1.23" data-path="daily-journals.html"><a href="daily-journals.html#april-23"><i class="fa fa-check"></i><b>1.23</b> April 23</a></li>
<li class="chapter" data-level="1.24" data-path="daily-journals.html"><a href="daily-journals.html#april-30"><i class="fa fa-check"></i><b>1.24</b> April 30</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html"><i class="fa fa-check"></i><b>2</b> Activity 1 - Morning walk</a>
<ul>
<li class="chapter" data-level="2.1" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#libraries"><i class="fa fa-check"></i><b>2.1</b> Libraries</a></li>
<li class="chapter" data-level="2.2" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#data"><i class="fa fa-check"></i><b>2.2</b> Data</a></li>
<li class="chapter" data-level="2.3" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#visualize-map"><i class="fa fa-check"></i><b>2.3</b> Visualize map</a></li>
<li class="chapter" data-level="2.4" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#write-kml"><i class="fa fa-check"></i><b>2.4</b> Write kml</a></li>
<li class="chapter" data-level="2.5" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#visualize-lat-lon"><i class="fa fa-check"></i><b>2.5</b> Visualize lat lon</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#polynomial"><i class="fa fa-check"></i><b>2.5.1</b> 1. Polynomial</a></li>
<li class="chapter" data-level="2.5.2" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#gam---low-rank-gaussian-process"><i class="fa fa-check"></i><b>2.5.2</b> 2. GAM - low rank gaussian process</a></li>
<li class="chapter" data-level="2.5.3" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#regression-tree"><i class="fa fa-check"></i><b>2.5.3</b> 3. Regression tree</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#visualize-all"><i class="fa fa-check"></i><b>2.6</b> Visualize all</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="activity-1---morning-walk.html"><a href="activity-1---morning-walk.html#comments"><i class="fa fa-check"></i><b>2.6.1</b> 4. Comments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><i class="fa fa-check"></i><b>3</b> Elevation data of Experiment plot in North Agronomy Farm</a>
<ul>
<li class="chapter" data-level="3.1" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#librarires"><i class="fa fa-check"></i><b>3.1</b> Librarires</a></li>
<li class="chapter" data-level="3.2" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#kansas-boundary"><i class="fa fa-check"></i><b>3.2</b> Kansas boundary</a></li>
<li class="chapter" data-level="3.3" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#my-data-north-agronomy-farm"><i class="fa fa-check"></i><b>3.3</b> My data: North Agronomy Farm</a></li>
<li class="chapter" data-level="3.4" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#extract-elevation"><i class="fa fa-check"></i><b>3.4</b> Extract elevation</a></li>
<li class="chapter" data-level="3.5" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#visualize-boundary-elevation"><i class="fa fa-check"></i><b>3.5</b> Visualize boundary + elevation</a></li>
<li class="chapter" data-level="3.6" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#models"><i class="fa fa-check"></i><b>3.6</b> Models</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#linear-with-iid-errors"><i class="fa fa-check"></i><b>3.6.1</b> 1. Linear with iid errors</a></li>
<li class="chapter" data-level="3.6.2" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#gam"><i class="fa fa-check"></i><b>3.6.2</b> 2. GAM</a></li>
<li class="chapter" data-level="3.6.3" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#regression-tree-1"><i class="fa fa-check"></i><b>3.6.3</b> 3. Regression tree</a></li>
<li class="chapter" data-level="3.6.4" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#support-vector-regression"><i class="fa fa-check"></i><b>3.6.4</b> 4. Support vector regression</a></li>
<li class="chapter" data-level="3.6.5" data-path="elevation-data-of-experiment-plot-in-north-agronomy-farm.html"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#boosted-regession-tree"><i class="fa fa-check"></i><b>3.6.5</b> 5. Boosted regession tree</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="activity-3.html"><a href="activity-3.html"><i class="fa fa-check"></i><b>4</b> Activity 3</a>
<ul>
<li class="chapter" data-level="4.1" data-path="activity-3.html"><a href="activity-3.html#libraries-1"><i class="fa fa-check"></i><b>4.1</b> Libraries</a></li>
<li class="chapter" data-level="4.2" data-path="activity-3.html"><a href="activity-3.html#english-grain-aphid-data"><i class="fa fa-check"></i><b>4.2</b> English grain Aphid Data</a></li>
<li class="chapter" data-level="4.3" data-path="activity-3.html"><a href="activity-3.html#kansas"><i class="fa fa-check"></i><b>4.3</b> Kansas</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spatial-df.html"><a href="spatial-df.html"><i class="fa fa-check"></i><b>5</b> Spatial DF</a></li>
<li class="chapter" data-level="6" data-path="viz-count.html"><a href="viz-count.html"><i class="fa fa-check"></i><b>6</b> Viz count</a>
<ul>
<li class="chapter" data-level="6.1" data-path="viz-count.html"><a href="viz-count.html#land-cover-data"><i class="fa fa-check"></i><b>6.1</b> Land Cover data</a></li>
<li class="chapter" data-level="6.2" data-path="viz-count.html"><a href="viz-count.html#raster-w-grassland"><i class="fa fa-check"></i><b>6.2</b> Raster w grassland</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="grassland-within-5-km-of-sampling.html"><a href="grassland-within-5-km-of-sampling.html"><i class="fa fa-check"></i><b>7</b> Grassland within 5 km of sampling</a></li>
<li class="chapter" data-level="8" data-path="run-models.html"><a href="run-models.html"><i class="fa fa-check"></i><b>8</b> Run models</a></li>
<li class="chapter" data-level="9" data-path="statistical-model.html"><a href="statistical-model.html"><i class="fa fa-check"></i><b>9</b> Statistical model</a>
<ul>
<li class="chapter" data-level="9.1" data-path="statistical-model.html"><a href="statistical-model.html#compare-models"><i class="fa fa-check"></i><b>9.1</b> Compare models</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="statistical-model.html"><a href="statistical-model.html#concurvity"><i class="fa fa-check"></i><b>9.1.1</b> Concurvity</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statistical-model.html"><a href="statistical-model.html#semivariogram-for-corr-resids"><i class="fa fa-check"></i><b>9.2</b> Semivariogram for corr resids</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-checking-comparison.html"><a href="model-checking-comparison.html"><i class="fa fa-check"></i><b>10</b> Model checking / comparison</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-checking-comparison.html"><a href="model-checking-comparison.html#predictions-in-space"><i class="fa fa-check"></i><b>10.1</b> Predictions in space</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="model-checking-comparison.html"><a href="model-checking-comparison.html#summary"><i class="fa fa-check"></i><b>10.1.1</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STAT 764 - Spring 2024</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="elevation-data-of-experiment-plot-in-north-agronomy-farm" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Elevation data of Experiment plot in North Agronomy Farm<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#elevation-data-of-experiment-plot-in-north-agronomy-farm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The goal of this activity is to visualize the elevation data of an experimental site in the North Agronomy Farm at Kansas State University. Also my goal is to predict elevation with different models and infer at what location we observe the lowest and highest elevation point.</p>
<div id="librarires" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Librarires<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#librarires" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb41-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb41-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb41-2" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb41-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb41-3" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb41-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb41-4" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="kansas-boundary" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Kansas boundary<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#kansas-boundary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb42-1" tabindex="-1"></a><span class="co"># Download shapefile of Kansas from census.gov</span></span>
<span id="cb42-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb42-2" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">&quot;http://www2.census.gov/geo/tiger/GENZ2015/shp/cb_2015_us_state_20m.zip&quot;</span>, <span class="at">destfile =</span> <span class="st">&quot;states.zip&quot;</span>)</span>
<span id="cb42-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb42-3" tabindex="-1"></a><span class="fu">unzip</span>(<span class="st">&quot;states.zip&quot;</span>)</span>
<span id="cb42-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb42-4" tabindex="-1"></a>sf.us <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;cb_2015_us_state_20m.shp&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `cb_2015_us_state_20m&#39; from data source 
##   `/Users/mariavalentinapereyrapicabea/Desktop/Maestria/Spring 2024/STAT 764/R STAT 764/bookdown/cb_2015_us_state_20m.shp&#39; 
##   using driver `ESRI Shapefile&#39;
## Simple feature collection with 52 features and 9 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -179.1743 ymin: 17.91377 xmax: 179.7739 ymax: 71.35256
## Geodetic CRS:  NAD83</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb44-1" tabindex="-1"></a>sf.kansas <span class="ot">&lt;-</span> sf.us[<span class="dv">48</span>,<span class="dv">6</span>]</span>
<span id="cb44-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb44-2" tabindex="-1"></a>sf.kansas <span class="ot">&lt;-</span> <span class="fu">as</span>(sf.kansas, <span class="st">&#39;Spatial&#39;</span>)</span>
<span id="cb44-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb44-3" tabindex="-1"></a><span class="fu">plot</span>(sf.kansas,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">col=</span><span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="my-data-north-agronomy-farm" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> My data: North Agronomy Farm<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#my-data-north-agronomy-farm" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb45-1" tabindex="-1"></a><span class="co"># Make shapefile of study area around Manhattan KS</span></span>
<span id="cb45-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb45-2" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.dropbox.com/scl/fi/b7d9254b8f26mhu6pc2km/Experiment_walk.gpx?rlkey=nmph96rzfz8rxmwxsxg3wn4p1&amp;dl=1&quot;</span></span>
<span id="cb45-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb45-3" tabindex="-1"></a>pt.study.area <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span>url,<span class="at">layer=</span><span class="st">&quot;track_points&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `track_points&#39; from data source 
##   `https://www.dropbox.com/scl/fi/b7d9254b8f26mhu6pc2km/Experiment_walk.gpx?rlkey=nmph96rzfz8rxmwxsxg3wn4p1&amp;dl=1&#39; 
##   using driver `GPX&#39;
## Simple feature collection with 318 features and 26 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -96.59412 ymin: 39.20585 xmax: -96.5938 ymax: 39.2064
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb47-1" tabindex="-1"></a>sf.study.area  <span class="ot">&lt;-</span> <span class="fu">st_polygon</span>(<span class="fu">list</span>(<span class="fu">rbind</span>(<span class="fu">st_coordinates</span>(pt.study.area),<span class="fu">st_coordinates</span>(pt.study.area)[<span class="dv">1</span>,])))</span>
<span id="cb47-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb47-2" tabindex="-1"></a>sf.study.area <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(sf.study.area, .<span class="dv">00006</span>)</span>
<span id="cb47-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb47-3" tabindex="-1"></a>sf.study.area <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="fu">st_sfc</span>(sf.study.area), <span class="at">crs =</span> <span class="fu">crs</span>(sf.kansas))</span>
<span id="cb47-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb47-4" tabindex="-1"></a></span>
<span id="cb47-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb47-5" tabindex="-1"></a><span class="co"># Kansas + North farm data</span></span>
<span id="cb47-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb47-6" tabindex="-1"></a>{<span class="fu">plot</span>(sf.kansas,<span class="at">main=</span><span class="st">&quot;&quot;</span>,<span class="at">col=</span><span class="st">&quot;white&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">102.0517</span>,<span class="sc">-</span><span class="fl">94.59193</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">36.99308</span>,<span class="fl">40.00308</span>))</span>
<span id="cb47-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb47-7" tabindex="-1"></a><span class="fu">plot</span>(sf.study.area, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="extract-elevation" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Extract elevation<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#extract-elevation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb48-1" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.dropbox.com/scl/fi/b7d9254b8f26mhu6pc2km/Experiment_walk.gpx?rlkey=nmph96rzfz8rxmwxsxg3wn4p1&amp;dl=1&quot;</span></span>
<span id="cb48-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb48-2" tabindex="-1"></a></span>
<span id="cb48-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb48-3" tabindex="-1"></a>pt.elev <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn=</span>url,<span class="at">layer=</span><span class="st">&quot;track_points&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `track_points&#39; from data source 
##   `https://www.dropbox.com/scl/fi/b7d9254b8f26mhu6pc2km/Experiment_walk.gpx?rlkey=nmph96rzfz8rxmwxsxg3wn4p1&amp;dl=1&#39; 
##   using driver `GPX&#39;
## Simple feature collection with 318 features and 26 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -96.59412 ymin: 39.20585 xmax: -96.5938 ymax: 39.2064
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb50-1" tabindex="-1"></a>pt.elev <span class="ot">&lt;-</span> pt.elev[,<span class="dv">4</span>] <span class="co"># Keep only elevation</span></span>
<span id="cb50-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb50-2" tabindex="-1"></a>pt.elev <span class="ot">&lt;-</span> pt.elev[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>),]</span>
<span id="cb50-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb50-3" tabindex="-1"></a><span class="co">#pt.elev &lt;- rbind(pt.elev,pt.study.area[,4])</span></span></code></pre></div>
</div>
<div id="visualize-boundary-elevation" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Visualize boundary + elevation<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#visualize-boundary-elevation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb51-1" tabindex="-1"></a>{<span class="fu">plot</span>(sf.study.area)</span>
<span id="cb51-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb51-2" tabindex="-1"></a><span class="fu">plot</span>(pt.elev,<span class="at">add=</span><span class="cn">TRUE</span>)}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb52-1" tabindex="-1"></a><span class="fu">hist</span>(pt.elev<span class="sc">$</span>ele,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb53-1" tabindex="-1"></a><span class="fu">summary</span>(pt.elev<span class="sc">$</span>ele)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   333.2   333.5   333.6   333.7   333.8   334.2</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb55-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb55-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb55-2" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>sf.study.area) <span class="sc">+</span></span>
<span id="cb55-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb55-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;North Agronomy Farm&quot;</span>)<span class="sc">+</span></span>
<span id="cb55-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb55-4" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>pt.elev, <span class="fu">aes</span>(<span class="at">color =</span> ele), <span class="at">size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb55-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb55-5" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">&quot;blue&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>, <span class="at">name =</span> <span class="st">&quot;Elevation (m)&quot;</span>)<span class="sc">+</span></span>
<span id="cb55-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb55-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb55-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb55-7" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-3.png" width="672" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb56-1" tabindex="-1"></a><span class="co"># Visualize with satelite image </span></span>
<span id="cb56-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb56-2" tabindex="-1"></a>mapview<span class="sc">::</span><span class="fu">mapview</span>(sf.study.area)  </span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e96895cd3231595b66c6" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-e96895cd3231595b66c6">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["polygon",420]},{"method":"addPolygons","args":[[[[{"lng":[-96.5941689710731,-96.59416891239169,-96.59416866546464,-96.594168259697,-96.594167696169,-96.59416697638086,-96.59416610224879,-96.5941650760999,-96.59416390066598,-96.59416257907624,-96.59416111484903,-96.59415951188237,-96.59415777444367,-96.59415590715831,-96.59415391499735,-96.59415180326431,-96.59414957758099,-96.59414724387258,-96.59414480835187,-96.59414227750266,-96.59413965806252,-96.59413695700491,-96.59413418152054,-96.59413133899828,-96.59412843700544,-96.59412548326766,-96.59411273683713,-96.59409957913988,-96.59408618018381,-96.59408305804394,-96.59407988478998,-96.5940766699305,-96.59407342309879,-96.5940701540239,-96.59406687250157,-96.59406358836479,-96.59406031145444,-96.59405021758944,-96.59403878704435,-96.59403568367915,-96.59403254435652,-96.59402937797626,-96.59402619351484,-96.59402300000001,-96.59400249906375,-96.59398399625701,-96.593981,-96.59396466337492,-96.59394922672648,-96.59394648528136,-96.59392743417636,-96.59391222394183,-96.59389605863183,-96.59389545975901,-96.59388045975901,-96.59387676696812,-96.59386676696813,-96.59386369176283,-96.593860593041,-96.5938574791866,-96.59385435862448,-96.59385123979769,-96.59384813114451,-96.5938450410758,-96.59384197795202,-96.59383895006083,-96.59383596559451,-96.59383303262786,-96.59383015909633,-96.5938273527746,-96.59382462125544,-96.59382197192932,-96.59381941196425,-96.5938169482865,-96.59381458756184,-96.59381233617745,-96.59381020022471,-96.59380818548264,-96.59380629740239,-96.59380454109235,-96.59380292130442,-96.59380144242108,-96.59380010844363,-96.59379892298131,-96.59379788924149,-96.59379701002109,-96.59379628769891,-96.5937957242293,-96.59379532113677,-96.59379507951193,-96.59379500000856,-96.59379508284169,-96.59379532778728,-96.59379573418256,-96.59379630092801,-96.59379702649022,-96.5937979089061,-96.59379894578818,-96.59379934959684,-96.59376415976672,-96.59376401346341,-96.59376402813076,-96.59376420372944,-96.5937645397882,-96.59376503540527,-96.59376568925069,-96.5937664995699,-96.59376746418843,-96.5937685805178,-96.59376984556239,-96.59377125592754,-96.59377280782857,-96.59377449710108,-96.59377631921197,-96.59377826927171,-96.59378034204741,-96.59378253197691,-96.59378483318363,-96.59378723949241,-96.59378974444606,-96.59379234132265,-96.59379502315362,-96.5937977827424,-96.59380061268381,-96.59380350538382,-96.59380645308003,-96.59380944786248,-96.59381985293675,-96.59382962687211,-96.5938339325935,-96.59384932201597,-96.5938637165594,-96.59386446125525,-96.59389046125526,-96.59389310642949,-96.59389579303082,-96.59389851516846,-96.5939012668737,-96.59392012937568,-96.59393407002058,-96.59393746237315,-96.59394090098586,-96.59394437410843,-96.59395978625105,-96.59396723303189,-96.59397033434678,-96.59397345950555,-96.5939765999092,-96.59397974691679,-96.5939828918692,-96.593986026113,-96.59398914102418,-96.59399222803194,-96.59399527864225,-96.59399828446126,-96.59400123721834,-96.59400412878885,-96.5940047262944,-96.59400562667288,-96.5940086679887,-96.59401167268493,-96.59401463271129,-96.59401754013723,-96.59402038717307,-96.59402316619099,-96.59402586974538,-96.59403086974537,-96.59403179993637,-96.59403979993638,-96.59404243552935,-96.59404497553565,-96.5940474129047,-96.5940497408708,-96.59405195297195,-96.59405404306779,-96.59405600535656,-96.59405783439135,-96.59405952509506,-96.59406107277464,-96.59406247313399,-96.59406372228599,-96.59406481676322,-96.59406575352762,-96.59406652997889,-96.59406714396175,-96.59406759377191,-96.59406767391484,-96.59406768195879,-96.59406945801378,-96.59407109458853,-96.59407509458853,-96.59407656605288,-96.59407789381272,-96.59407907430601,-96.59408010436577,-96.59408098122861,-96.59408170254213,-96.5940822663712,-96.59408267120324,-96.59408291595214,-96.59408299996134,-96.59408292300546,-96.59408268529093,-96.59408228745549,-96.59408173056644,-96.59408101611777,-96.59408014602617,-96.59407912262589,-96.59407794866245,-96.59407691776893,-96.59407800659464,-96.59407966742242,-96.59408118767885,-96.5940825632278,-96.59408379032681,-96.5940848656373,-96.59408578623371,-96.59408654961133,-96.59408715369329,-96.59408759683605,-96.59408787783394,-96.59408799592246,-96.59408795078033,-96.59408774253038,-96.59408737173916,-96.59408683941551,-96.59408614700772,-96.5940852963996,-96.59408428990541,-96.59408408884745,-96.59408480278215,-96.5940858720424,-96.59408678793059,-96.59408754797677,-96.59408815013127,-96.59408859277019,-96.59408887469984,-96.59408899515988,-96.59408896921779,-96.59409068904361,-96.5940926760311,-96.5940945303893,-96.59409624695961,-96.59409782096674,-96.59409924803195,-96.59410052418535,-96.5941016458768,-96.59410260998588,-96.59410341383057,-96.59410405517465,-96.59410453223397,-96.59410484368142,-96.59410498865059,-96.59410496673816,-96.59410477800512,-96.5941044229765,-96.59410390263994,-96.59410321844297,-96.59410237228893,-96.59410160358227,-96.59410361415556,-96.59410635934691,-96.59410903010408,-96.59411161941719,-96.59411412049012,-96.59411652675836,-96.59411883190623,-96.59412102988345,-96.59412311492105,-96.59412508154645,-96.59412692459792,-96.59412863923801,-96.59413022096636,-96.59413166563145,-96.59413566563146,-96.5941369942073,-96.59413817257489,-96.59413919751566,-96.59414006623017,-96.59414077634563,-96.59414080899137,-96.59414208481847,-96.5941440363289,-96.59414585563512,-96.59414753773009,-96.5941490779844,-96.59415047215899,-96.59415171641686,-96.59415280733361,-96.59415374190684,-96.59415451756445,-96.59415513217169,-96.59415558403707,-96.59415587191695,-96.59415599501907,-96.59415595300462,-96.59415574598921,-96.59415537454261,-96.59415483968709,-96.59415414289467,-96.59415328608303,-96.59415227161028,-96.59415110226841,-96.59414978127566,-96.59414831226762,-96.59414669928726,-96.59414494677377,-96.59414305955036,-96.59414104281102,-96.59412880768187,-96.59412867526932,-96.59412827018031,-96.59412807341245,-96.59413010493711,-96.59413201807179,-96.59414401807179,-96.59414572991686,-96.59414730794803,-96.59414874800287,-96.59415004628278,-96.59415119936324,-96.59415220420266,-96.59415305815052,-96.59415375895432,-96.59415430476547,-96.59415469414425,-96.59415492606358,-96.59415499991169,-96.5941549435985,-96.59415536817072,-96.59415760181605,-96.59415971418774,-96.59416169941048,-96.59416355196255,-96.59416526669133,-96.59416683882746,-96.59416826399823,-96.59416953823968,-96.59417065800766,-96.59417162018762,-96.59417242210341,-96.59417306152456,-96.59417353667261,-96.59417553667261,-96.59417584086586,-96.5941759863376,-96.59417597270196,-96.59417579999511,-96.59417546867515,-96.59417497962086,-96.59417433412939,-96.59417353391287,-96.59417258109376,-96.59417147819933,-96.59417022815488,-96.5941689710731],"lat":[39.20636416416644,39.20636624119138,39.20636932711068,39.20637239618603,39.20637544024699,39.20637845118969,39.20638142099843,39.20638434176706,39.20638720571991,39.20639000523264,39.2063927328524,39.20639538131776,39.20639794357803,39.20640041281197,39.20640278244605,39.20640504617183,39.20640719796287,39.20640923209069,39.20641114314008,39.20641292602345,39.20641457599444,39.20641608866053,39.2064174599947,39.20641868634623,39.20641976445032,39.20642069143687,39.20642433327416,39.20642871917325,39.2064335045147,39.20643452410918,39.20643537133378,39.20643604364982,39.20643653904269,39.20643685602798,39.20643699365584,39.20643695151388,39.20643672972836,39.20643576840789,39.20643888582927,39.2064396440473,39.20644023601319,39.20644066004877,39.20644091495191,39.206441,39.206441,39.20644192514033,39.206442,39.206442,39.20644494031399,39.20644539696962,39.20644811855605,39.20645132071068,39.20645581107458,39.20645597409638,39.20645997409638,39.20646083484053,39.20646283484054,39.20646336710587,39.20646373874699,39.2064639487584,39.20646399657188,39.20646388205807,39.20646360552679,39.20646316772624,39.20646256984093,39.2064618134885,39.20646090071535,39.20645983399109,39.20645861620185,39.2064572506425,39.20645574100771,39.20645409138196,39.20645230622849,39.20645039037723,39.20644834901173,39.20644618765512,39.2064439121552,39.20644152866857,39.20643904364402,39.20643646380505,39.20643379613171,39.20643104784168,39.20642822637074,39.20642533935271,39.20642239459872,39.20641940007613,39.20641636388695,39.20641329424593,39.2064101994583,39.20640708789735,39.20640396798177,39.20640084815281,39.20639773685152,39.20639464249587,39.20639157345796,39.20638853804143,39.20638554445892,39.20638260080989,39.20638162037298,39.20590037566924,39.20589727099482,39.20589416290976,39.20589105975443,39.20588796985599,39.205884901506,39.20588186293823,39.20587886230652,39.20587590766289,39.20587300693598,39.20587016790973,39.20586739820251,39.20586470524669,39.20586209626867,39.2058595782695,39.20585715800611,39.20585484197313,39.20585263638552,39.20585054716186,39.20584857990846,39.20584673990435,39.20584503208707,39.20584346103947,39.20584203097737,39.20584074573826,39.20583960877101,39.20583862312662,39.20583779144999,39.20583519018142,39.20583062901159,39.20582882024935,39.20582304921592,39.20581729139855,39.20581699926362,39.20580699926362,39.20580605236622,39.20580523033539,39.20580453497355,39.20580396780539,39.20580053825958,39.2057964380699,39.20579554717578,39.20579485602386,39.20579436697592,39.20579265451563,39.20579116515946,39.20579062907736,39.20579025635664,39.20579004802285,39.20579000464922,39.2057901263551,39.2057904128056,39.20579086321256,39.20579147633665,39.20579225049085,39.20579318354504,39.20579427293188,39.20579551565389,39.20579581047413,39.20579594854935,39.20579657752072,39.20579736301901,39.20579830293969,39.20579939476451,39.20580063556821,39.20580202202642,39.20580355042449,39.20580655042449,39.20580712010175,39.20581212010175,39.20581386554856,39.20581574738353,39.20581776038303,39.20581989895935,39.20582215717619,39.20582452876518,39.20582700714319,39.20582958543073,39.20583225647094,39.20583501284951,39.20583784691523,39.20584075080127,39.20584371644698,39.20584673562026,39.20584979994047,39.20585290090159,39.20585602989595,39.20585691712247,39.20585692769056,39.20585953480563,39.20586223166369,39.20586923166369,39.20587196894416,39.20587477874228,39.20587765352006,39.20588058556517,39.20588356701167,39.20588658986107,39.20588964600381,39.20589272724101,39.20589582530648,39.20589893188887,39.20590203865398,39.20590513726714,39.20590821941552,39.20591127683048,39.20591430130974,39.20591728473936,39.20592021911553,39.20592309656606,39.20592529102118,39.20592684369605,39.20592949627137,39.20593223183807,39.20593504295348,39.20593792196942,39.20594086105297,39.20594385220777,39.2059468872958,39.20594995805951,39.20595305614429,39.20595617312118,39.20595930050985,39.20596242980162,39.20596555248263,39.20596866005703,39.20597174407005,39.20597479613102,39.20597780793623,39.20598077129146,39.20598127527798,39.20598295346956,39.20598588009428,39.2059888582814,39.20599187999937,39.20599493709925,39.20599802133667,39.2060011243941,39.20600423790322,39.20600619327864,39.20600810898185,39.2060105720429,39.20601313644237,39.20601579504638,39.20601854045901,39.20602136504284,39.2060242609402,39.20602722009502,39.20603023427527,39.20603329509586,39.20603639404193,39.20603952249257,39.20604267174477,39.20604583303768,39.20604899757696,39.2060521565592,39.20605530119648,39.20605842274078,39.20606151250832,39.20606456190372,39.20606685523578,39.20606774214311,39.20606912517194,39.20607064698022,39.20607230357369,39.20607409060433,39.20607600338175,39.20607803688554,39.20608018577838,39.20608244442013,39.20608480688258,39.20608726696502,39.20608981821054,39.20609245392291,39.20609516718425,39.20610316718425,39.2061060075603,39.20610891346802,39.20611187697039,39.20611488997304,39.20611794424642,39.20611812763111,39.20611957878834,39.20612204848953,39.20612461713544,39.20612727765673,39.20613002273116,39.20613284480383,39.2061357361079,39.20613868868603,39.2061416944122,39.20614474501415,39.20614783209609,39.20615094716184,39.2061540816382,39.20615722689858,39.20616037428666,39.2061635151403,39.20616664081533,39.20616974270935,39.20617281228542,39.20617584109554,39.20617882080391,39.20618174320987,39.20618460027044,39.20618738412251,39.20619008710443,39.20619270177715,39.20619522094462,39.20619763767368,39.20621154122954,39.20621323395803,39.20621632982998,39.2062173980931,39.2062198365112,39.20622239900815,39.20623939900815,39.20624196134311,39.2062446081887,39.20624733256315,39.20625012728018,39.20625298496796,39.20625589808858,39.20625885895788,39.20626185976578,39.20626489259683,39.20626794945113,39.20627102226538,39.20627410293422,39.20627615779539,39.20627654111768,39.20627878250811,39.20628113854043,39.20628360266162,39.20628616801798,39.20628882747427,39.20629157363349,39.20629439885752,39.20629729528829,39.20630025486972,39.20630326937004,39.20630633040476,39.20630942945996,39.20631255791594,39.20632855791595,39.20633163299044,39.20633471964797,39.20633780970149,39.20634089495497,39.20634396722511,39.20634701836303,39.20635004027591,39.20635302494846,39.20635596446414,39.20635885102621,39.20636167697836,39.20636416416644]}]]],null,"sf.study.area",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"polygon","stroke":true,"color":"#333333","weight":0.5,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.6,"smoothFactor":1,"noClip":false},"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>st_sfc.sf.study.area.&emsp;<\/th><td>sfc_POLYGON&emsp;<\/td><\/tr><\/table><\/div>",{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},"1",{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},{"stroke":true,"weight":1,"opacity":0.9,"fillOpacity":0.84,"bringToFront":false,"sendToBack":false}]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-96.5941759863376,39.20579000464922,-96.59376401346341,39.20646399657188,true,"sf.study.area","Zoom to sf.study.area","<strong> sf.study.area <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"sf.study.area",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#6666FF"],"labels":["sf.study.area"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"sf.study.area"}]}],"limits":{"lat":[39.20579000464922,39.20646399657188],"lng":[-96.5941759863376,-96.59376401346341]},"fitBounds":[39.20579000464922,-96.5941759863376,39.20646399657188,-96.59376401346341,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb57-1" tabindex="-1"></a><span class="co"># Transform pointfiles and shapefiles to utm zone to a planar coordinate reference system</span></span>
<span id="cb57-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb57-2" tabindex="-1"></a>pt.elev.utm <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(pt.elev,<span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=14 +datum=WGS84  +units=m&quot;</span>))</span>
<span id="cb57-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb57-3" tabindex="-1"></a>sf.study.area.utm <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(sf.study.area,<span class="fu">CRS</span>(<span class="st">&quot;+proj=utm +zone=14 +datum=WGS84  +units=m&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb58-1" tabindex="-1"></a><span class="co"># Make data.frame for statistical analysis</span></span>
<span id="cb58-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb58-2" tabindex="-1"></a>df.elev <span class="ot">&lt;-</span> <span class="fu">data.frame</span> (<span class="at">elev =</span> pt.elev<span class="sc">$</span>ele,</span>
<span id="cb58-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb58-3" tabindex="-1"></a>                       <span class="at">long =</span> <span class="fu">st_coordinates</span>(pt.elev)[,<span class="dv">1</span>],</span>
<span id="cb58-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb58-4" tabindex="-1"></a>                       <span class="at">lat =</span> <span class="fu">st_coordinates</span>(pt.elev)[,<span class="dv">2</span>],</span>
<span id="cb58-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb58-5" tabindex="-1"></a>                       <span class="at">s1 =</span> <span class="fu">st_coordinates</span>(pt.elev.utm)[,<span class="dv">1</span>],</span>
<span id="cb58-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb58-6" tabindex="-1"></a>                       <span class="at">s2 =</span> <span class="fu">st_coordinates</span>(pt.elev.utm)[,<span class="dv">2</span>])</span></code></pre></div>
</div>
<div id="models" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Models<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="linear-with-iid-errors" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> 1. Linear with iid errors<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#linear-with-iid-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-1" tabindex="-1"></a><span class="co"># Statistical analysis 1: non-hierarchical linear model with iid errors</span></span>
<span id="cb59-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-2" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(elev<span class="sc">~</span>s1<span class="sc">+</span><span class="fu">I</span>(s1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span>s2<span class="sc">+</span><span class="fu">I</span>(s2<span class="sc">^</span><span class="dv">2</span>),<span class="at">data=</span>df.elev)</span>
<span id="cb59-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-3" tabindex="-1"></a><span class="co"># Make raster of study area to be able to map predictions from m1</span></span>
<span id="cb59-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-4" tabindex="-1"></a>rl.E.y_lin <span class="ot">&lt;-</span> <span class="fu">raster</span>(,<span class="at">nrow=</span><span class="dv">100</span>,<span class="at">ncols=</span><span class="dv">100</span>,<span class="at">ext=</span><span class="fu">extent</span>(sf.study.area.utm),<span class="at">crs=</span><span class="fu">crs</span>(sf.study.area.utm))</span>
<span id="cb59-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-5" tabindex="-1"></a><span class="co"># Make data.frame to be able to make predictions at each pixel (cell of raster)</span></span>
<span id="cb59-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-6" tabindex="-1"></a>df.pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">elev =</span> <span class="cn">NA</span>,</span>
<span id="cb59-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-7" tabindex="-1"></a>                      <span class="at">s1 =</span> <span class="fu">xyFromCell</span>(rl.E.y_lin,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y_lin[]))[,<span class="dv">1</span>],</span>
<span id="cb59-8"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-8" tabindex="-1"></a>                      <span class="at">s2 =</span> <span class="fu">xyFromCell</span>(rl.E.y_lin,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y_lin[]))[,<span class="dv">2</span>])</span>
<span id="cb59-9"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-9" tabindex="-1"></a></span>
<span id="cb59-10"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-10" tabindex="-1"></a><span class="co"># Make spatial predictions at each pixel</span></span>
<span id="cb59-11"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-11" tabindex="-1"></a>df.pred<span class="sc">$</span>elev <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,df.pred[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb59-12"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-12" tabindex="-1"></a></span>
<span id="cb59-13"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-13" tabindex="-1"></a><span class="co"># View first 6 rows of predictions</span></span>
<span id="cb59-14"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb59-14" tabindex="-1"></a><span class="fu">head</span>(df.pred) </span></code></pre></div>
<pre><code>##       elev       s1      s2
## 1 333.9162 707730.7 4342447
## 2 333.9042 707731.1 4342447
## 3 333.8923 707731.4 4342447
## 4 333.8803 707731.8 4342447
## 5 333.8684 707732.2 4342447
## 6 333.8564 707732.5 4342447</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb61-1" tabindex="-1"></a><span class="co"># Fill raster file with predictions </span></span>
<span id="cb61-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb61-2" tabindex="-1"></a>rl.E.y_lin[] <span class="ot">&lt;-</span> <span class="fu">c</span>(df.pred<span class="sc">$</span>elev)</span>
<span id="cb61-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb61-3" tabindex="-1"></a></span>
<span id="cb61-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb61-4" tabindex="-1"></a>rl.E.y_lin <span class="ot">&lt;-</span> <span class="fu">mask</span>(rl.E.y_lin,sf.study.area.utm)</span>
<span id="cb61-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb61-5" tabindex="-1"></a></span>
<span id="cb61-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb61-6" tabindex="-1"></a><span class="co"># Estimate coordinates and amount of maximum elevation</span></span>
<span id="cb61-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb61-7" tabindex="-1"></a><span class="fu">xyFromCell</span>(rl.E.y_lin,<span class="at">cell=</span><span class="fu">which.max</span>(rl.E.y_lin[]))</span></code></pre></div>
<pre><code>##             x       y
## [1,] 707740.3 4342381</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb63-1" tabindex="-1"></a>rl.E.y_lin[<span class="fu">which.max</span>(rl.E.y_lin[])]</span></code></pre></div>
<pre><code>## [1] 334.2931</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb65-1" tabindex="-1"></a><span class="co"># Plot estimate coordinates of maximum elevation</span></span>
<span id="cb65-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb65-2" tabindex="-1"></a>{<span class="fu">plot</span>(rl.E.y_lin, <span class="at">main =</span> <span class="st">&quot;Linear with iid errors&quot;</span>) <span class="co"># Plot map of predictions</span></span>
<span id="cb65-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb65-3" tabindex="-1"></a><span class="fu">plot</span>(sf.study.area.utm,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb65-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb65-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(rl.E.y_lin,<span class="at">cell=</span><span class="fu">which.max</span>(rl.E.y_lin[])),<span class="at">col=</span><span class="st">&quot;purple&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>)</span>
<span id="cb65-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb65-5" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(rl.E.y_lin,<span class="at">cell=</span><span class="fu">which.min</span>(rl.E.y_lin[])),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>)}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="gam" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> 2. GAM<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#gam" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-1" tabindex="-1"></a><span class="co"># Try low-rank Gaussian process (i.e., modern kriging model)</span></span>
<span id="cb66-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-2" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb66-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-3" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">gam</span>(elev<span class="sc">~</span><span class="fu">s</span>(s1,s2,<span class="at">bs=</span><span class="st">&quot;gp&quot;</span>),<span class="at">data=</span>df.elev)</span>
<span id="cb66-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-4" tabindex="-1"></a></span>
<span id="cb66-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-5" tabindex="-1"></a><span class="co"># Make raster of study area to be able to map predictions from m1</span></span>
<span id="cb66-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-6" tabindex="-1"></a>rl.E.y_gam <span class="ot">&lt;-</span> <span class="fu">raster</span>(,<span class="at">nrow=</span><span class="dv">100</span>,<span class="at">ncols=</span><span class="dv">100</span>,<span class="at">ext=</span><span class="fu">extent</span>(sf.study.area.utm),<span class="at">crs=</span><span class="fu">crs</span>(sf.study.area.utm))</span>
<span id="cb66-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-7" tabindex="-1"></a><span class="co"># Make data.frame to be able to make predictions at each pixel (cell of raster)</span></span>
<span id="cb66-8"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-8" tabindex="-1"></a>df.pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">elev =</span> <span class="cn">NA</span>,</span>
<span id="cb66-9"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-9" tabindex="-1"></a>                      <span class="at">s1 =</span> <span class="fu">xyFromCell</span>(rl.E.y_gam,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y_gam[]))[,<span class="dv">1</span>],</span>
<span id="cb66-10"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-10" tabindex="-1"></a>                      <span class="at">s2 =</span> <span class="fu">xyFromCell</span>(rl.E.y_gam,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y_gam[]))[,<span class="dv">2</span>])</span>
<span id="cb66-11"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-11" tabindex="-1"></a></span>
<span id="cb66-12"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-12" tabindex="-1"></a><span class="co"># Make spatial predictions at each pixel</span></span>
<span id="cb66-13"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-13" tabindex="-1"></a>df.pred<span class="sc">$</span>elev <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,df.pred[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb66-14"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-14" tabindex="-1"></a></span>
<span id="cb66-15"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-15" tabindex="-1"></a><span class="co"># View first 6 rows of predictions</span></span>
<span id="cb66-16"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb66-16" tabindex="-1"></a><span class="fu">head</span>(df.pred) </span></code></pre></div>
<pre><code>##       elev       s1      s2
## 1 333.8337 707730.7 4342447
## 2 333.8222 707731.1 4342447
## 3 333.8107 707731.4 4342447
## 4 333.7993 707731.8 4342447
## 5 333.7879 707732.2 4342447
## 6 333.7766 707732.5 4342447</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb68-1" tabindex="-1"></a><span class="co"># Fill raster file with predictions </span></span>
<span id="cb68-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb68-2" tabindex="-1"></a>rl.E.y_gam[] <span class="ot">&lt;-</span> <span class="fu">c</span>(df.pred<span class="sc">$</span>elev)</span>
<span id="cb68-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb68-3" tabindex="-1"></a></span>
<span id="cb68-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb68-4" tabindex="-1"></a>rl.E.y_gam <span class="ot">&lt;-</span> <span class="fu">mask</span>(rl.E.y_gam,sf.study.area.utm)</span>
<span id="cb68-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb68-5" tabindex="-1"></a></span>
<span id="cb68-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb68-6" tabindex="-1"></a><span class="co"># Estimate coordinates and amount of maximum elevation</span></span>
<span id="cb68-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb68-7" tabindex="-1"></a><span class="fu">xyFromCell</span>(rl.E.y_gam,<span class="at">cell=</span><span class="fu">which.max</span>(rl.E.y_gam[]))</span></code></pre></div>
<pre><code>##             x       y
## [1,] 707740.3 4342381</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb70-1" tabindex="-1"></a>rl.E.y_gam[<span class="fu">which.max</span>(rl.E.y_gam[])]</span></code></pre></div>
<pre><code>## [1] 334.3422</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb72-1" tabindex="-1"></a><span class="co"># Plot estimate coordinates of maximum elevation</span></span>
<span id="cb72-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb72-2" tabindex="-1"></a>{<span class="fu">plot</span>(rl.E.y_gam, <span class="at">main =</span> <span class="st">&quot;Generalized additive model&quot;</span>) <span class="co"># Plot map of predictions</span></span>
<span id="cb72-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb72-3" tabindex="-1"></a><span class="fu">plot</span>(sf.study.area.utm,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb72-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb72-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(rl.E.y_gam,<span class="at">cell=</span><span class="fu">which.max</span>(rl.E.y_gam[])),<span class="at">col=</span><span class="st">&quot;purple&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>)</span>
<span id="cb72-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb72-5" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(rl.E.y_lin,<span class="at">cell=</span><span class="fu">which.min</span>(rl.E.y_lin[])),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>)}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="regression-tree-1" class="section level3 hasAnchor" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> 3. Regression tree<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#regression-tree-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-1" tabindex="-1"></a><span class="co"># Try a regression tree instead!</span></span>
<span id="cb73-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-2" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb73-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-3" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(elev<span class="sc">~</span>s1<span class="sc">+</span>s2,<span class="at">data=</span>df.elev)</span>
<span id="cb73-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-4" tabindex="-1"></a></span>
<span id="cb73-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-5" tabindex="-1"></a><span class="co"># Make raster of study area to be able to map predictions from m1</span></span>
<span id="cb73-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-6" tabindex="-1"></a>rl.E.y_rt <span class="ot">&lt;-</span> <span class="fu">raster</span>(,<span class="at">nrow=</span><span class="dv">100</span>,<span class="at">ncols=</span><span class="dv">100</span>,<span class="at">ext=</span><span class="fu">extent</span>(sf.study.area.utm),<span class="at">crs=</span><span class="fu">crs</span>(sf.study.area.utm))</span>
<span id="cb73-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-7" tabindex="-1"></a><span class="co"># Make data.frame to be able to make predictions at each pixel (cell of raster)</span></span>
<span id="cb73-8"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-8" tabindex="-1"></a>df.pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">elev =</span> <span class="cn">NA</span>,</span>
<span id="cb73-9"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-9" tabindex="-1"></a>                      <span class="at">s1 =</span> <span class="fu">xyFromCell</span>(rl.E.y_rt,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y_rt[]))[,<span class="dv">1</span>],</span>
<span id="cb73-10"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-10" tabindex="-1"></a>                      <span class="at">s2 =</span> <span class="fu">xyFromCell</span>(rl.E.y_rt,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y_rt[]))[,<span class="dv">2</span>])</span>
<span id="cb73-11"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-11" tabindex="-1"></a></span>
<span id="cb73-12"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-12" tabindex="-1"></a><span class="co"># Make spatial predictions at each pixel</span></span>
<span id="cb73-13"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-13" tabindex="-1"></a>df.pred<span class="sc">$</span>elev <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,df.pred[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb73-14"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-14" tabindex="-1"></a></span>
<span id="cb73-15"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-15" tabindex="-1"></a><span class="co"># View first 6 rows of predictions</span></span>
<span id="cb73-16"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb73-16" tabindex="-1"></a><span class="fu">head</span>(df.pred) </span></code></pre></div>
<pre><code>##       elev       s1      s2
## 1 333.7143 707730.7 4342447
## 2 333.7143 707731.1 4342447
## 3 333.7143 707731.4 4342447
## 4 333.7143 707731.8 4342447
## 5 333.7143 707732.2 4342447
## 6 333.7143 707732.5 4342447</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb75-1" tabindex="-1"></a><span class="co"># Fill raster file with predictions </span></span>
<span id="cb75-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb75-2" tabindex="-1"></a>rl.E.y_rt[] <span class="ot">&lt;-</span> <span class="fu">c</span>(df.pred<span class="sc">$</span>elev)</span>
<span id="cb75-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb75-3" tabindex="-1"></a></span>
<span id="cb75-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb75-4" tabindex="-1"></a>rl.E.y_rt <span class="ot">&lt;-</span> <span class="fu">mask</span>(rl.E.y_rt,sf.study.area.utm)</span>
<span id="cb75-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb75-5" tabindex="-1"></a></span>
<span id="cb75-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb75-6" tabindex="-1"></a><span class="co"># Estimate coordinates and amount of maximum elevation</span></span>
<span id="cb75-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb75-7" tabindex="-1"></a><span class="fu">xyFromCell</span>(rl.E.y_rt,<span class="at">cell=</span><span class="fu">which.max</span>(rl.E.y_rt[]))</span></code></pre></div>
<pre><code>##             x       y
## [1,] 707737.7 4342400</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb77-1" tabindex="-1"></a>rl.E.y_rt[<span class="fu">which.max</span>(rl.E.y_rt[])]</span></code></pre></div>
<pre><code>## [1] 334.0958</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb79-1" tabindex="-1"></a><span class="co"># Plot estimate coordinates of maximum elevation</span></span>
<span id="cb79-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb79-2" tabindex="-1"></a>{<span class="fu">plot</span>(rl.E.y_rt, <span class="at">main =</span> <span class="st">&quot;Regression tree&quot;</span>) <span class="co"># Plot map of predictions</span></span>
<span id="cb79-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb79-3" tabindex="-1"></a><span class="fu">plot</span>(sf.study.area.utm,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb79-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb79-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(rl.E.y_rt,<span class="at">cell=</span><span class="fu">which.max</span>(rl.E.y_rt[])),<span class="at">col=</span><span class="st">&quot;purple&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>)</span>
<span id="cb79-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb79-5" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(rl.E.y_lin,<span class="at">cell=</span><span class="fu">which.min</span>(rl.E.y_lin[])),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>)}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="support-vector-regression" class="section level3 hasAnchor" number="3.6.4">
<h3><span class="header-section-number">3.6.4</span> 4. Support vector regression<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#support-vector-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-1" tabindex="-1"></a><span class="co"># Try support vector regression (or machine)!</span></span>
<span id="cb80-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-2" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb80-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-3" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">svm</span>(elev<span class="sc">~</span>s1<span class="sc">+</span>s2,<span class="at">data=</span>df.elev)</span>
<span id="cb80-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-4" tabindex="-1"></a></span>
<span id="cb80-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-5" tabindex="-1"></a><span class="co"># Make raster of study area to be able to map predictions from m1</span></span>
<span id="cb80-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-6" tabindex="-1"></a>rl.E.y_svr <span class="ot">&lt;-</span> <span class="fu">raster</span>(,<span class="at">nrow=</span><span class="dv">100</span>,<span class="at">ncols=</span><span class="dv">100</span>,<span class="at">ext=</span><span class="fu">extent</span>(sf.study.area.utm),<span class="at">crs=</span><span class="fu">crs</span>(sf.study.area.utm))</span>
<span id="cb80-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-7" tabindex="-1"></a><span class="co"># Make data.frame to be able to make predictions at each pixel (cell of raster)</span></span>
<span id="cb80-8"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-8" tabindex="-1"></a>df.pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">elev =</span> <span class="cn">NA</span>,</span>
<span id="cb80-9"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-9" tabindex="-1"></a>                      <span class="at">s1 =</span> <span class="fu">xyFromCell</span>(rl.E.y_svr,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y_svr[]))[,<span class="dv">1</span>],</span>
<span id="cb80-10"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-10" tabindex="-1"></a>                      <span class="at">s2 =</span> <span class="fu">xyFromCell</span>(rl.E.y_svr,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y_svr[]))[,<span class="dv">2</span>])</span>
<span id="cb80-11"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-11" tabindex="-1"></a></span>
<span id="cb80-12"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-12" tabindex="-1"></a><span class="co"># Make spatial predictions at each pixel</span></span>
<span id="cb80-13"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-13" tabindex="-1"></a>df.pred<span class="sc">$</span>elev <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,df.pred[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb80-14"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-14" tabindex="-1"></a></span>
<span id="cb80-15"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-15" tabindex="-1"></a><span class="co"># View first 6 rows of predictions</span></span>
<span id="cb80-16"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb80-16" tabindex="-1"></a><span class="fu">head</span>(df.pred) </span></code></pre></div>
<pre><code>##       elev       s1      s2
## 1 333.7520 707730.7 4342447
## 2 333.7524 707731.1 4342447
## 3 333.7522 707731.4 4342447
## 4 333.7515 707731.8 4342447
## 5 333.7500 707732.2 4342447
## 6 333.7479 707732.5 4342447</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb82-1" tabindex="-1"></a><span class="co"># Fill raster file with predictions </span></span>
<span id="cb82-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb82-2" tabindex="-1"></a>rl.E.y_svr[] <span class="ot">&lt;-</span> <span class="fu">c</span>(df.pred<span class="sc">$</span>elev)</span>
<span id="cb82-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb82-3" tabindex="-1"></a></span>
<span id="cb82-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb82-4" tabindex="-1"></a>rl.E.y_svr <span class="ot">&lt;-</span> <span class="fu">mask</span>(rl.E.y_svr,sf.study.area.utm)</span>
<span id="cb82-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb82-5" tabindex="-1"></a></span>
<span id="cb82-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb82-6" tabindex="-1"></a><span class="co"># Estimate coordinates and amount of maximum elevation</span></span>
<span id="cb82-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb82-7" tabindex="-1"></a><span class="fu">xyFromCell</span>(rl.E.y_svr,<span class="at">cell=</span><span class="fu">which.max</span>(rl.E.y_svr[]))</span></code></pre></div>
<pre><code>##           x       y
## [1,] 707744 4342389</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb84-1" tabindex="-1"></a>rl.E.y_svr[<span class="fu">which.max</span>(rl.E.y_svr[])]</span></code></pre></div>
<pre><code>## [1] 334.1314</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb86-1" tabindex="-1"></a><span class="co"># Plot estimate coordinates of maximum elevation</span></span>
<span id="cb86-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb86-2" tabindex="-1"></a>{<span class="fu">plot</span>(rl.E.y_svr, <span class="at">main =</span> <span class="st">&quot;Support vector regression&quot;</span>) <span class="co"># Plot map of predictions</span></span>
<span id="cb86-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb86-3" tabindex="-1"></a><span class="fu">plot</span>(sf.study.area.utm,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb86-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb86-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(rl.E.y_svr,<span class="at">cell=</span><span class="fu">which.max</span>(rl.E.y_svr[])),<span class="at">col=</span><span class="st">&quot;purple&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>)</span>
<span id="cb86-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb86-5" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(rl.E.y_lin,<span class="at">cell=</span><span class="fu">which.min</span>(rl.E.y_lin[])),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>)}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="boosted-regession-tree" class="section level3 hasAnchor" number="3.6.5">
<h3><span class="header-section-number">3.6.5</span> 5. Boosted regession tree<a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#boosted-regession-tree" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb87-1" tabindex="-1"></a><span class="co"># Try boosted regression tree!</span></span>
<span id="cb87-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb87-2" tabindex="-1"></a><span class="fu">library</span>(gbm)</span>
<span id="cb87-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb87-3" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">gbm</span>(elev<span class="sc">~</span>s1<span class="sc">+</span>s2,<span class="at">data=</span>df.elev)</span></code></pre></div>
<pre><code>## Distribution not specified, assuming gaussian ...</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-1" tabindex="-1"></a><span class="co"># Make raster of study area to be able to map predictions from m1</span></span>
<span id="cb89-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-2" tabindex="-1"></a>rl.E.y_gbm <span class="ot">&lt;-</span> <span class="fu">raster</span>(,<span class="at">nrow=</span><span class="dv">100</span>,<span class="at">ncols=</span><span class="dv">100</span>,<span class="at">ext=</span><span class="fu">extent</span>(sf.study.area.utm),<span class="at">crs=</span><span class="fu">crs</span>(sf.study.area.utm))</span>
<span id="cb89-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-3" tabindex="-1"></a><span class="co"># Make data.frame to be able to make predictions at each pixel (cell of raster)</span></span>
<span id="cb89-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-4" tabindex="-1"></a>df.pred <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">elev =</span> <span class="cn">NA</span>,</span>
<span id="cb89-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-5" tabindex="-1"></a>                      <span class="at">s1 =</span> <span class="fu">xyFromCell</span>(rl.E.y_gbm,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y_gbm[]))[,<span class="dv">1</span>],</span>
<span id="cb89-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-6" tabindex="-1"></a>                      <span class="at">s2 =</span> <span class="fu">xyFromCell</span>(rl.E.y_gbm,<span class="at">cell=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rl.E.y_gbm[]))[,<span class="dv">2</span>])</span>
<span id="cb89-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-7" tabindex="-1"></a></span>
<span id="cb89-8"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-8" tabindex="-1"></a><span class="co"># Make spatial predictions at each pixel</span></span>
<span id="cb89-9"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-9" tabindex="-1"></a>df.pred<span class="sc">$</span>elev <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,df.pred[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb89-10"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-10" tabindex="-1"></a></span>
<span id="cb89-11"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-11" tabindex="-1"></a><span class="co"># View first 6 rows of predictions</span></span>
<span id="cb89-12"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb89-12" tabindex="-1"></a><span class="fu">head</span>(df.pred) </span></code></pre></div>
<pre><code>##       elev       s1      s2
## 1 333.7946 707730.7 4342447
## 2 333.7946 707731.1 4342447
## 3 333.7946 707731.4 4342447
## 4 333.7946 707731.8 4342447
## 5 333.7946 707732.2 4342447
## 6 333.7946 707732.5 4342447</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb91-1" tabindex="-1"></a><span class="co"># Fill raster file with predictions </span></span>
<span id="cb91-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb91-2" tabindex="-1"></a>rl.E.y_gbm[] <span class="ot">&lt;-</span> <span class="fu">c</span>(df.pred<span class="sc">$</span>elev)</span>
<span id="cb91-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb91-3" tabindex="-1"></a></span>
<span id="cb91-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb91-4" tabindex="-1"></a>rl.E.y_gbm <span class="ot">&lt;-</span> <span class="fu">mask</span>(rl.E.y_gbm,sf.study.area.utm)</span>
<span id="cb91-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb91-5" tabindex="-1"></a></span>
<span id="cb91-6"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb91-6" tabindex="-1"></a><span class="co"># Estimate coordinates and amount of maximum elevation</span></span>
<span id="cb91-7"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb91-7" tabindex="-1"></a><span class="fu">xyFromCell</span>(rl.E.y_gbm,<span class="at">cell=</span><span class="fu">which.max</span>(rl.E.y_gbm[]))</span></code></pre></div>
<pre><code>##             x       y
## [1,] 707739.5 4342392</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb93-1" tabindex="-1"></a>rl.E.y_gbm[<span class="fu">which.max</span>(rl.E.y_gbm[])]</span></code></pre></div>
<pre><code>## [1] 334.1906</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb95-1" tabindex="-1"></a><span class="co"># Plot estimate coordinates of maximum elevation</span></span>
<span id="cb95-2"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb95-2" tabindex="-1"></a>{<span class="fu">plot</span>(rl.E.y_gbm, <span class="at">main =</span> <span class="st">&quot;Boosted regression tree&quot;</span>) <span class="co"># Plot map of predictions</span></span>
<span id="cb95-3"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb95-3" tabindex="-1"></a><span class="fu">plot</span>(sf.study.area.utm,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb95-4"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb95-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(rl.E.y_gbm,<span class="at">cell=</span><span class="fu">which.max</span>(rl.E.y_gbm[])),<span class="at">col=</span><span class="st">&quot;purple&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>)</span>
<span id="cb95-5"><a href="elevation-data-of-experiment-plot-in-north-agronomy-farm.html#cb95-5" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">xyFromCell</span>(rl.E.y_lin,<span class="at">cell=</span><span class="fu">which.min</span>(rl.E.y_lin[])),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">pch=</span><span class="st">&quot;*&quot;</span>,<span class="at">cex=</span><span class="dv">3</span>)}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="activity-1---morning-walk.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="activity-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-Activity2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["book.pdf", "PDF"], ["book.epub", "EPUB"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
